plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5)
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 1)
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
#kuai 22.093181, -159.526705
#oahu 21.437636, -157.995673
#molokai 21.145345, -157.020336
#maui 20.799146, -156.338797
#hawaii 19.547732, -155.659076
library(RColorBrewer)
RColorBrewer::display.brewer.pal(Set2)
RColorBrewer::display.brewer.pal(name = Set2)
RColorBrewer::display.brewer.pal(name = "Set2")
RColorBrewer::display.brewer.pal(name = "Set2",n=5)
brewer.pal(name = "Set2",n=5)
lats <- c(0,rep(19.547732,6),rep(20.799146,4),21.145345,21.437636,19.547732,rep(20.799146,2),rep(21.437636,6),rep(22.093181,4))
longs <- c(0,rep(-155.659076,6),rep(-156.338797,4),-157.020336,-157.995673,-155.659076,rep(-156.338797,2),rep(-157.995673,6),rep(-159.526705,4))
island <- c("black",rep("#66C2A5",6),rep("#FC8D62",4),"#8DA0CB","#E78AC3","#66C2A5",rep("#FC8D62",2),rep("#E78AC3",6),rep("#A6D854",4))
fonts <- c(3,4,3,4,4,3,4,3,3,3,3,3,3,4,4,3,3,3,3,3,3,3,3,3,3,3)
places <- data.frame(crnm,lats,longs,island,fonts)
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
us_map(regions = "states",include = "Hawaii")
plot_usmap(regions = "states",include = "Hawaii",fill=piece)
plot_usmap(regions = "states",include = "Hawaii",fill= brewer.pal(name = "Set2",n=5))
install.packages(c("maps", "mapdata", "ggmap"))
library(ggplot2)
library(ggmap)
library(maps)
library(mapdata)
library(ggmap)
install.packages("jpeg")
library(maps)
library(mapdata)
library(ggmap)
install.packages("ggplot2")
library(ggplot2)
library(ggmap)
install.packages("ggmap")
library(mapdata)
library(maps)
library(mapdata)
install.packages("ggmap")
us_map(regions = "states",include = "Hawaii")
##map of Hawaii to color-code
library(usmap)
plot_usmap(regions = "states",include = "Hawaii",fill= brewer.pal(name = "Set2",n=5))
#kuai 22.093181, -159.526705
#oahu 21.437636, -157.995673
#molokai 21.145345, -157.020336
#maui 20.799146, -156.338797
#hawaii 19.547732, -155.659076
library(RColorBrewer)
###prepping figures for the NSF Postdoc
library(ape); library(geiger); library(phytools)
plot_usmap(regions = "states",include = "Hawaii",fill= brewer.pal(name = "Set2",n=5))
plot_usmap(regions = "states",include = "Hawaii")
lats <- c(0,rep(19.547732,6),rep(20.799146,4),21.145345,21.437636,19.547732,rep(20.799146,2),rep(21.437636,6),rep(22.093181,4))
longs <- c(0,rep(-155.659076,6),rep(-156.338797,4),-157.020336,-157.995673,-155.659076,rep(-156.338797,2),rep(-157.995673,6),rep(-159.526705,4))
island <- c("black",rep("#66C2A5",6),rep("#FC8D62",4),"#8DA0CB","#E78AC3","#66C2A5",rep("#FC8D62",2),rep("#E78AC3",6),rep("#A6D854",4))
fonts <- c(3,4,3,4,4,3,4,3,3,3,3,3,3,4,4,3,3,3,3,3,3,3,3,3,3,3)
places <- data.frame(crnm,lats,longs,island,fonts)
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
plot_usmap(regions = "states",include = "Hawaii")
plot_usmap(regions = "states",include = "Hawaii",fill="gray")
us_map(regions = "states",include = "Hawaii")
nrow(us_map(regions = "states",include = "Hawaii"))
dat <- us_map(regions = "states",include = "Hawaii")
dat$piece[1]
dat$piece[,1]
dat[dat$piece ==1,]
nrow(dat[dat$piece ==1,])
nrow(dat[dat$piece ==2,])
nrow(dat[dat$piece ==3,])
nrow(dat[dat$piece ==4,])
nrow(dat[dat$piece ==5,])
nrow(dat[dat$piece ==6,])
nrow(dat[dat$piece ==7,])
cols <- c(rep("black",71),rep("red",31),rep("blue",38),rep("yellow",28),rep("green",24))
plot_usmap(regions = "states",include = "Hawaii",fill=cols)
cols <- c(rep("#66C2A5",71),rep("#FC8D62",31),rep("#E78AC3",38),rep("#A6D854",28),rep("#8DA0CB",24))
plot_usmap(regions = "states",include = "Hawaii",fill=cols)
crk$edge
crk$Nnode
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2,show.node.label = TRUE)
nodelabels("node1",node = 1)
nodelabels("node1",node = 2)
nodelabels("node1",node = 27)
nodelabels("node1",node = 28)
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nrow(crk$tip.label)
length(crk$tip.label)
nodelabels("3.7 Myr",node = 28,frame = "n",)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = (0,0.5))
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0,0.5))
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0,0.5))
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0.5,0))
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0.8,0))
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0,1))
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0,2))
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0,-2))
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0,-0.8))
nodelabels("1.9 Myr",node = 31,frame = "n",adj = c(0,-0.8))
nodelabels("1.9 Myr",node = 33,frame = "n",adj = c(0,-0.8))
nodelabels("0.43 Myr",node = 38,frame = "n",adj = c(0,-0.8))
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0,-0.8))
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0,-0.8))
nodelabels("1.9 Myr",node = 33,frame = "n",adj = c(0,-0.8))
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0,-0.8))
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0,0))
nodelabels("1.9 Myr",node = 33,frame = "n",adj = c(0,0))
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0,0))
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0,0))
nodelabels("1.9 Myr",node = 33,frame = "n",adj = c(0,0))
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0,0))
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(-1,0))
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(1,0))
nodelabels("1.9 Myr",node = 33,frame = "n",adj = c(1,0))
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(1,0))
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0.75,0))
nodelabels("1.9 Myr",node = 33,frame = "n",adj = c(0.5,0))
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0.5,0))
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0.75,-0.25))
nodelabels("1.9 Myr",node = 33,frame = "n",adj = c(0.5,-0.25))
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0.5,-0.25))
nodelabels("3.7 Myr",node = 28,frame = "n",adj = c(0.75,-0.25),col = "red")
nodelabels("1.9 Myr",node = 33,frame = "n",adj = c(0.5,-0.25),col = "red")
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0.5,-0.25), col = "red")
nodelabels("3.70 Myr",node = 28,frame = "n",adj = c(0.75,-0.25),col = "red")
nodelabels("1.90 Myr",node = 33,frame = "n",adj = c(0.5,-0.25),col = "red")
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0.5,-0.25), col = "red")
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.70 Myr",node = 28,frame = "n",adj = c(0.75,-0.25),col = "red")
nodelabels("1.90 Myr",node = 33,frame = "n",adj = c(0.5,-0.25),col = "red")
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0.5,-0.25), col = "red")
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.70 Myr",node = 28,frame = "n",adj = c(0.75,-0.25),col = "red")
nodelabels("1.90 Myr",node = 33,frame = "n",adj = c(0.5,-0.25),col = "red")
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0.5,-0.25), col = "red")
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 3)
nodelabels("3.70 Myr",node = 28,frame = "n",adj = c(0.75,-0.25),col = "red")
nodelabels("1.90 Myr",node = 33,frame = "n",adj = c(0.5,-0.25),col = "red")
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0.5,-0.25), col = "red")
island <- c("black",rep("#FC8D62",6),rep("#66C2A5",4),"#8DA0CB","#E78AC3","#FC8D62",rep("#66C2A5",2),rep("#E78AC3",6),rep("#A6D854",4))
fonts <- c(3,4,3,4,4,3,4,3,3,3,3,3,3,4,4,3,3,3,3,3,3,3,3,3,3,3)
places <- data.frame(crnm,lats,longs,island,fonts)
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.70 Myr",node = 28,frame = "n",adj = c(0.75,-0.25),col = "red")
nodelabels("1.90 Myr",node = 33,frame = "n",adj = c(0.5,-0.25),col = "red")
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0.5,-0.25), col = "red")
cols <- c(rep("#FC8D62",71),rep("#66C2A5",31),rep("#E78AC3",38),rep("#A6D854",28),rep("#8DA0CB",24))
plot_usmap(regions = "states",include = "Hawaii",fill=cols)
###prepping figures for the NSF Postdoc
library(ape); library(geiger); library(phytools)
crk <- read.tree(text = "(P_kukui,(((((((((((L_pruna,L_hualalai),L_kohalensis),(L_kona,(L_nigra,L_paranigra))),(L_makaio,L_orientalis)),(L_prosea,L_vespertina)),L_molokaiensis),L_tantalis),((((L_cerasina,L_eukolea),L_fugax),(L_neospisa,(L_melewiki,L_spisa))),((L_hapapa,L_pacifica),L_oahuensis))))),((((L_kanaele,L_wailua),L_koloa),L_kokeensis))));")
plot(crk)
crnm <- crk$tip.label
#kuai 22.093181, -159.526705
#oahu 21.437636, -157.995673 "#E78AC3"
#molokai 21.145345, -157.020336 "#8DA0CB"
#maui 20.799146, -156.338797  #66C2A5
#hawaii 19.547732, -155.659076 "#FC8D62"
library(RColorBrewer)
lats <- c(0,rep(19.547732,6),rep(20.799146,4),21.145345,21.437636,19.547732,rep(20.799146,2),rep(21.437636,6),rep(22.093181,4))
longs <- c(0,rep(-155.659076,6),rep(-156.338797,4),-157.020336,-157.995673,-155.659076,rep(-156.338797,2),rep(-157.995673,6),rep(-159.526705,4))
island <- c("black",rep("#FC8D62",6),rep("#66C2A5",4),"#8DA0CB","#E78AC3","#FC8D62",rep("#66C2A5",2),rep("#E78AC3",6),rep("#A6D854",4))
fonts <- c(3,4,3,4,4,3,4,3,3,3,3,3,3,4,4,3,3,3,3,3,3,3,3,3,3,3)
places <- data.frame(crnm,lats,longs,island,fonts)
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.70 Myr",node = 28,frame = "n",adj = c(0.75,-0.25),col = "red")
nodelabels("1.90 Myr",node = 33,frame = "n",adj = c(0.5,-0.25),col = "red")
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0.5,-0.25), col = "red")
fonts <- c(3,4,3,3,3,3,3,4,4,3,3,3,3,4,3,3,4,4,3,3,3,3,3,3,3,3)
places <- data.frame(crnm,lats,longs,island,fonts)
plot(crk,tip.color = as.character(places$island),font = places$fonts,cex = 1.5,no.margin = TRUE,label.offset = 0.5,node.depth = 2)
nodelabels("3.70 Myr",node = 28,frame = "n",adj = c(0.75,-0.25),col = "red")
nodelabels("1.90 Myr",node = 33,frame = "n",adj = c(0.5,-0.25),col = "red")
nodelabels("0.43 Myr",node = 36,frame = "n",adj = c(0.5,-0.25), col = "red")
library(ggplot2); library(reshape2); library(dplyr)
###all data
alda <- read.csv("~/Desktop/2019_light_assays.csv",header=TRUE)
cps_norm <- alda$cps / alda$Concentration
alda2 <- cbind(alda,cps_norm)
ggplot(data=alda2, aes(x = Species, y = log10(cps/(Concentration)),color=count_type)) + geom_boxplot() +
xlab("Species") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = Species, y = log10(cps/(Concentration)))) +
geom_boxplot(aes(color=count_type)) + geom_point(aes(shape=date),position = "jitter") +
xlab("Species") + ylab("log10( Photon count )") + facet_wrap(.~type)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = date, y = log10(cps/(Concentration)))) +
+ geom_point(aes(shape=date),position = "jitter") +
xlab("Species") + ylab("log10( Photon count )") + facet_wrap(.~type)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = date, y = log10(cps/(Concentration)))) +
geom_point(aes(shape=date),position = "jitter") +
xlab("Species") + ylab("log10( Photon count )") + facet_wrap(.~type)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date), y = log10(cps/(Concentration)))) +
geom_point(aes(shape=date),position = "jitter") +
xlab("Species") + ylab("log10( Photon count )") + facet_wrap(.~type)
format(betterDates,"%a %b %d")
###all data
alda <- read.csv("~/Desktop/2019_light_assays.csv",header=TRUE)
cps_norm <- alda$cps / alda$Concentration
alda2 <- cbind(alda,cps_norm)
ggplot(data=alda2, aes(x = Species, y = log10(cps/(Concentration)),color=count_type)) + geom_boxplot() +
xlab("Species") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = Species, y = log10(cps/(Concentration)))) +
geom_boxplot(aes(color=count_type)) + geom_point(aes(shape=date),position = "jitter") +
xlab("Species") + ylab("log10( Photon count )") + facet_wrap(.~type)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date,), y = log10(cps/(Concentration)))) +
geom_point(aes(shape=date),position = "jitter") +
xlab("Species") + ylab("log10( Photon count )") + facet_wrap(.~type)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R), y = log10(cps/(Concentration)))) +
geom_point(aes(shape=date),position = "jitter") +
xlab("Species") + ylab("log10( Photon count )") + facet_wrap(.~type)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R), y = log10(cps/(Concentration)))) +
geom_point(position = "jitter") +
xlab("Species") + ylab("log10( Photon count )") + facet_wrap(.~type)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R), y = log10(cps/(Concentration)))) +
geom_point(position = "jitter") +
xlab("Species") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = dae_R, y = log10(cps/(Concentration)))) +
geom_point(position = "jitter") +
xlab("Species") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = date_R, y = log10(cps/(Concentration)))) +
geom_point(position = "jitter") +
xlab("Species") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R), y = log10(cps/(Concentration)))) +
geom_point(position = "jitter") +
xlab("Species") + ylab("log10( Photon count )")
View(alda2)
unique(alda2$date_R)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = date_R, y = log10(cps/(Concentration)))) +
geom_point(position = "jitter") +
xlab("Date") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_point(position = "jitter") +
xlab("Date") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_point(aes(color=type),position = "jitter") +
xlab("Date") + ylab("log10( Photon count )")
View(alda2)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant" & alda2$ == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
+ geom_line() + geom_point(aes(color=type),position = "jitter") +
xlab("Date") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant" & alda2$ == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line() + geom_point(aes(color=type),position = "jitter") +
xlab("Date") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line() + geom_point(aes(color=type),position = "jitter") +
xlab("Date") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(group=Species) + geom_point(aes(color=type),position = "jitter") +
xlab("Date") + ylab("log10( Photon count )")
View(alda2)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(factor=Species) + geom_point(aes(color=type),position = "jitter") +
xlab("Date") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(factor=Species)) + geom_point(aes(color=type),position = "jitter") +
xlab("Date") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(group=Species)) + geom_point(aes(color=type),position = "jitter") +
xlab("Date") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(group=Species,color=Species)) + geom_point(aes(color=type),position = "jitter") +
xlab("Date") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(group=Species,color=Species)) + geom_point(aes(shape=type),position = "jitter") +
xlab("Date") + ylab("log10( Photon count )")
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(group=Species,color=Species)) + geom_point(aposition = "jitter") +
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
View(alda2)
unique(alda2$date_R)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant" & alda2$date_R == "4/26/19"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(group=Species,color=Species)) + geom_point(aposition = "jitter") +
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant" & alda2$date_R <= "4/26/19"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(group=Species,color=Species)) + geom_point(aposition = "jitter") +
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant" & as.Date(alda2$date_R,"%m/%d/%Y") <= "4/26/19"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(group=Species,color=Species)) + geom_point(aposition = "jitter") +
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant" & as.Date(alda2$date_R,"%m/%d/%Y") =< "4/26/19"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(group=Species,color=Species)) + geom_point(aposition = "jitter") +
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant" & alda2$date_R =="4/26/19"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(group=Species,color=Species)) + geom_point(aposition = "jitter") +
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
alda3 <- subset.data.frame(alda,alda$Species != "CNO" & alda$type != "negative")
View(alda3)
alda3 <- alda[!(df$type %in% df$type[df$Species == "CNO"]),]
alda3 <- alda[!(alda$type %in% alda$type[alda$Species == "CNO"]),]
alda3 <- alda[!(alda$Species %in% alda$Species[alda$type == "negative"]),]
View(alda3)
ggplot(data=subset.data.frame(alda2,alda3$fraction == "supernatant" & alda2$date_R =="4/26/19"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(group=Species,color=Species)) + geom_point(aposition = "jitter") +
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
ggplot(data=subset.data.frame(alda2,alda3$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(group=Species,color=Species)) + geom_point(aposition = "jitter") +
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
ggplot(data=subset.data.frame(alda3,alda3$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_line(aes(group=Species,color=Species)) + geom_point(aposition = "jitter") +
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
ggplot(data=subset.data.frame(alda3,alda3$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_point(aposition = "jitter") + #geom_line(aes(group=Species,color=Species))
xlab("Date") + ylab("log10( Photon count )") #+ facet_grid(.~type)
ggplot(data=subset.data.frame(alda3,alda3$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_point(aes(color=Species),aposition = "jitter") + #geom_line(aes(group=Species,color=Species))
xlab("Date") + ylab("log10( Photon count )") #+ facet_grid(.~type)
ggplot(data=subset.data.frame(alda3,alda3$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_point(aes(color=Species),aposition = "jitter") + #geom_line(aes(group=Species,color=Species))
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
ggplot(data=subset.data.frame(alda3,alda3$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_point(aes(color=Species),aposition = "jitter") + #geom_line(aes(group=Species,color=Species))
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
ggplot(data=subset.data.frame(alda3,alda3$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_boxplot(aes(color=Species))+#,aposition = "jitter") + #geom_line(aes(group=Species,color=Species))
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
head(alda3)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = as.Date(date_R,"%m/%d/%Y"), y = log10(cps/(Concentration)))) +
geom_boxplot(aes(color=Species))+#,aposition = "jitter") + #geom_line(aes(group=Species,color=Species))
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
ggplot(data=subset.data.frame(alda2,alda2$fraction == "supernatant"), aes(x = Species, y = log10(cps/(Concentration)))) +
geom_boxplot(aes(color=Species))+#,aposition = "jitter") + #geom_line(aes(group=Species,color=Species))
xlab("Date") + ylab("log10( Photon count )") + facet_grid(.~type)
head(alda3)
head(alda2)
View(alda)
alda1 <- alda %>% separate(count_type,c("before","after"))
library(ggplot2); library(reshape2); library(dplyr)
library(ggplot2); library(reshape2); library(dplyr); library(tidyverse)
alda1 <- alda %>% separate(count_type,c("before","after"))
View(alda1)
View(alda)
alda1 <- reshape(alda,idvar="Replicate",timevar = "count_type",direction = "wide")
maindir <- "~/Documents/GitHub/Cypridinidae_Emission/"
setwd(maindir)
source("1_Emission_Functions.R")
source("2_Read_Datasets.R")
source("3_Calculate_parameters.R")
source("4_MutagenesisLuciferase.R")
clean <- subset(alldata, error < 0.02 | replicate=="Vhil_tsuji" | replicate=="Cnoc_ohmiya" | replicate=="Pgra_huvard")
#calculate means, SDs, and counts, grouped by abbreviation
aggregate(clean[, 9:10], list(clean$abbreviation), FUN=mean) -> means
aggregate(clean[, 9:10], list(clean $abbreviation), FUN=sd) -> sds
aggregate(clean[, 9:10], list(clean $abbreviation), FUN=length) -> counts
#Now construct data frame as table for above information
cbind(subset(means, select="Group.1"), counts$sgMax, signif(means$sgMax,4), signif(sds$sgMax,2), signif(means$sgfwhm,4), signif(sds$sgfwhm,2)) -> table1
colnames(table1)[c(1,2,3,4,5,6)] <- c("Species", "N", "Lmax_Mean", "Lmax_SD", "FWHM_Mean", "FWHM_SD")
table1
#***************************************************Supplemental Figures
#Supplemental Figure S1
require(ape)
require(phytools)
read.tree(file="./LuciferaseTree_dNds/results/phylogenies/all_aa.treefile") -> lucplus_tree
read.tree(file="/Users/nicholaihensley/Documents/GitHub/Cypridinidae_Emission/LuciferaseTree_dNds/results/phylogenies/all_aa.treefile") -> lucplus_tree
midpoint.root(lucplus_tree) -> lucplus_tree_r
ladderize(lucplus_tree_r)-> lprl
lprl
plot(lprl)
library(MuMIn)
options(na.action = "na.fail")
####incorporating var-covar analyses into the model
rownames(dat2)
dat <- read.csv("Raw Data/expression-kinetics/clipboard-alignment_4671897282832913936.translated.csv",header=FALSE, stringsAsFactors=FALSE, colClasses = c("character"))
dat <- read.csv("./Raw Data/expression-kinetics/clipboard-alignment_4671897282832913936.translated.csv",header=FALSE, stringsAsFactors=FALSE, colClasses = c("character"))
dat <- read.csv("/Users/nicholaihensley/Documents/GitHub/Cypridinidae_Emission/Raw Data/expression-kinetics/clipboard-alignment_4671897282832913936.translated.csv",header=FALSE, stringsAsFactors=FALSE, colClasses = c("character"))
colnames(dat)[1] <- "sp"
colnames(dat)[589] <- "decay"
colnames(dat)[2:588] <- paste("V",seq(1,587),sep="")
dat2 <- dat[-c(2,8),]
dat2 <- dat2[,c("sp","V93","V115","V142","V152","V160","V189","V261","V285",
"V320","V371","V389","V477","V506","V581","decay")]
dat2$sp
####incorporating var-covar analyses into the model
sp_seq <- rownames(dat2$sp)
head
tree_seq <- lprl$tip.label
tree_seq
pgls_tree <- drop.tip(lprl,!(sp_seq %in% tree_seq))
plot(pgls_tree)
sp_seq %in% tree_seq
sp_seq
####incorporating var-covar analyses into the model
sp_seq <- rownames(dat2$sp)
tree_seq <- lprl$tip.label
sp_seq %in% tree_seq
sp_seq
####incorporating var-covar analyses into the model
sp_seq <- rownames(dat2$sp)
sp_seq
rownames(dat2$sp)
####incorporating var-covar analyses into the model
sp_seq <- dat2$sp
tree_seq <- lprl$tip.label
pgls_tree <- drop.tip(lprl,!(sp_seq %in% tree_seq))
plot(pgls_tree)
pgls_tree <- drop.tip(lprl,!(tree_seq %in% sp_seq))
sp_seq
tree_seq
sp_seq[1] <- "Vargula_hilgendorfii_AAA30332_luciferase"
sp_seq
tree_seq <- lprl$tip.label
tree_seq
sp_seq[1] <- "Vargula_hilgendorfii_AAA30332_luciferase"
sp_seq[2] <- "KHC_sequenced"
sp_seq[3] <- "MSH_sequenced"
sp_seq[4] <- "PMO_sequenced"
sp_seq[5] <- "SVD_sequenced"
sp_seq[6] <- "SVU_sequenced"
sp_seq[7] <- "Maristella_sp_AG_DN382219_c2_g1"
sp_seq[8] <- "Maristella_sp_VAD_DN92476_c5_g4"
sp_seq[9] <- "Photeros_annecohenae_DN96747_c10_g3"
sp_seq[10] <- "Photeros_macelroyi_DN131343_c2_g2"
sp_seq[11] <- "Photeros_sp_WLU_DN218316_c2_g1"
sq_seq
sp_seq
pgls_tree <- drop.tip(lprl,!(tree_seq %in% sp_seq))
tree_seq <- lprl$tip.label
tree_seq
sp_seq
pgls_tree <- drop.tip(lprl,!(tree_seq %in% sp_seq))
!(tree_seq %in% sp_seq)
nomat <- tree_seq[(tree_seq %in% sp_seq),]
nomat <- tree_seq[!(tree_seq %in% sp_seq),]
nomat <- tree_seq[!(tree_seq %in% sp_seq)]
nomat <- tree_seq[(tree_seq %in% sp_seq)]
nomat
nomat <- tree_seq[!(tree_seq %in% sp_seq)]
nomat
pgls_tree <- drop.tip(lprl,nomat)
plot(pgls_tree)
bm.model = corBrownian(1,pgls_tree)
dt2 = dat2[match(pgls_tree$tip.label, row.names(dat2)),] #data and tree must be in same order
View(dt2)
dt2 = dat2[match(pgls_tree$tip.label, dat2$sp),] #data and tree must be in same order
View(dt2)
dat2$sp
pgls_tree$tip.label
dt2 <- dat2
row.names(dt2) <- dat2$sp
View(dt2)
dt2 = dat2[match(pgls_tree$tip.label, row.names(dt2)),] #data and tree must be in same order
row.names(dt2) <- sp_seq
dt2 <- dat2
row.names(dt2) <- sp_seq
dt2 = dat2[match(pgls_tree$tip.label, row.names(dt2)),] #data and tree must be in same order
bm.model = corBrownian(1,pgls_tree)
gblm2 <- gls(decay~V93 + V115 + V152 + V160 + V189 + V261 + V371 + V389 + V477 + V506 + V581, data = dt2,)
library(nlme)
gblm2 <- gls(decay~V93 + V115 + V152 + V160 + V189 + V261 + V371 + V389 + V477 + V506 + V581, correlation=bm.model, data = dt2)
View(dt2)
row.names(dt2) <- sp_seq
View(dt2)
dt2 = dat2[match(pgls_tree$tip.label, row.names(dt2)),] #data and tree must be in same order
View(dt2)
row.names(dt2) <- dt2$sp
gblm2 <- gls(decay~V93 + V115 + V152 + V160 + V189 + V261 + V371 + V389 + V477 + V506 + V581, correlation=bm.model, data = dt2)
View(dt2)
####incorporating var-covar analyses into the model
sp_seq <- dat2$sp
sp_seq
sp_seq[1] <- "Vargula_hilgendorfii_AAA30332_luciferase"
sp_seq[2] <- "KHC_sequenced"
sp_seq[3] <- "MSH_sequenced"
sp_seq[4] <- "PMO_sequenced"
sp_seq[5] <- "SVD_sequenced"
sp_seq[6] <- "SVU_sequenced"
sp_seq[7] <- "Maristella_sp_AG_DN382219_c2_g1"
sp_seq[8] <- "Maristella_sp_VAD_DN92476_c5_g4"
sp_seq[9] <- "Photeros_annecohenae_DN96747_c10_g3"
sp_seq[10] <- "Photeros_macelroyi_DN131343_c2_g2"
sp_seq[11] <- "Photeros_sp_WLU_DN218316_c2_g1"
tree_seq <- lprl$tip.label
nomat <- tree_seq[!(tree_seq %in% sp_seq)]
pgls_tree <- drop.tip(lprl,nomat) #create var-covar matrix with BM model
dt2 <- dat2
row.names(dt2) <- sp_seq
dt2 = dat2[match(pgls_tree$tip.label, row.names(dt2)),] #data and tree must be in same order
gblm2 <- gls(decay~V93 + V115 + V152 + V160 + V189 + V261 + V371 + V389 + V477 + V506 + V581, correlation=bm.model, data = dt2)
bm.model = corBrownian(1,pgls_tree)
gblm2 <- gls(decay ~ V93 + V115 + V152 + V160 + V189 + V261 + V371 + V389 + V477 + V506 + V581, correlation=bm.model, data = dt2)
row.names(dt2) <- sp_seq
dt2 <- dat2
row.names(dt2) <- sp_seq
ViEw9dr2
View(dt2)
dt2 = dat2[match(pgls_tree$tip.label, row.names(dt2)),] #data and tree must be in same order
pgls_tree$tip.label
gblm2 <- gls(decay ~ V93 + V115 + V152 + V160 + V189 + V261 + V371 + V389 + V477 + V506 + V581, correlation=bm.model, data = dt2)
bm.model = corBrownian(0.5,pgls_tree)
library(nlme)
gblm2 <- gls(decay ~ V93 + V115 + V152 + V160 + V189 + V261 + V371 + V389 + V477 + V506 + V581, correlation=bm.model, data = dt2)
bm.model = corBrownian(1,pgls_tree)
library(nlme)
gblm2 <- gls(decay ~ V93 + V115 + V152 + V160 + V189 + V261 + V371 + V389 + V477 + V506 + V581, correlation=bm.model, data = dt2)
plot(bm.model)
bm.model
gblm2 <- gls(decay ~ V93 + V115 + V152 + V160 + V189 + V261 + V371 + V389 + V477 + V506 + V581, correlation=bm.model, data = dt2)
gblm2
gblm2 <- gls(decay ~ V93 + V115 + V152 + V160 + V189 + V261 + V371 + V389 + V477 + V506 + V581, data = dt2)
